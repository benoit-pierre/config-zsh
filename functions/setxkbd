# X11 keyboard configuration.

setxkbd()
{
  xinput list |
  #    ↳ TypeMatrix.com USB Keyboard               id=8    [slave  keyboard (3)]
  sed -n 's/^\s\+↳ \(\<.\+\>\) USB Keyboard\s\+id=\([0-9]\+\)\s\+\[slave \+keyboard ([0-9]\+)\]$/\2 \1/p' |
  while read id type
  do
    if [[ "$type" = 'TypeMatrix.com' ]]
    then
      setxkbmap -device "$id" us -variant colemak -option -option caps:capslock,shift:both_capslock
    else
      setxkbmap -device "$id" us -option -option caps:backspace,compose:rwin,shift:both_capslock
    fi
  done

  # Keyboard auto-repeat:
  # - on and fast
  # - enabled for capslock too
  xkbset repeatkeys rate 250 8
  xkbset repeatkeys 66

  # Enable sticky keys.
  xkbset exp 60 \=sticky \=twokey \=latchlock
  xkbset sticky -twokey latchlock
}

